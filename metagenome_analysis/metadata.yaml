project_title: "colorectal_biomarker_metagenomics — minimal metagenomic profiling"
doi: "https://doi.org/10.1038/s41591-025-03693-9"
project_slug: colorectal_biomarker_metagenomics
description: >
  One-sample, Taiga/SEPAL-friendly workflow: fetch & subsample (<1 GB FASTQ),
  trim + human decontamination (KneadData), then taxonomic profiling (MetaPhlAn 4).

data_source:
  - "ENA/SRA: SRR32733476 — subsampled to 1,500,000 reads"
  - "Host decontam index: Bowtie2 hg37dec_v0.1 (human reference subset)"
  - "MetaPhlAn DB: mpa_vJan25_CHOCOPhlAnSGB_202503 (installed under workflow/db/metaphlan/)"

domain: shotgun_metagenomics
ref_genome_host_filter:
  - "Homo sapiens — hg37dec_v0.1 Bowtie2 index (host removal)"
taxonomic_database:
  - "MetaPhlAn v4 index: mpa_vJan25_CHOCOPhlAnSGB_202503"

tools:
  - aria2c (download helper)
  - seqtk >=1.3
  - pigz >=2.6
  - bowtie2 2.4.4
  - trimmomatic 0.39
  - kneaddata 0.12.0
  - metaphlan 4.1.1
  - python 3.10+
  - pandas (parsing/report)

parameters:
  threads: 4
  subsample_reads_per_sample: 1500000
  subsample_seed: 42
  file_size_target_per_fastq_gz: "<= 1 GB"

layout:
  raw_fastqs: workflow/data/raw/
  processed_fastqs: workflow/data/processed/
  qc_dir: workflow/qc/kneaddata/
  db_dir: workflow/db/
  results_dir: workflow/results/
  scripts:
    - workflow/01_fetch_and_subsample.sh
    - workflow/02_run_workflow.sh

samples_analyzed:
  - id: SRR32733476
    inputs:
      subsampled_fastq_gz: "workflow/data/processed/SRR32733476.sub.fastq.gz"
    qc_outputs:
      kneaddata_log: "workflow/qc/kneaddata/SRR32733476.sub.log"
      cleaned_fastq_gz: "workflow/qc/kneaddata/SRR32733476.sub.fastq.gz"
    profiling_outputs:
      metaphlan_tsv: "workflow/results/SRR32733476_metaphlan.tsv"
      top20_phylum_csv: "workflow/results/SRR32733476_metaphlan_top20_phylum.csv"
      top20_genus_csv: "workflow/results/SRR32733476_metaphlan_top20_genus.csv"
      top20_species_csv: "workflow/results/SRR32733476_metaphlan_top20_species.csv"


estimates:
  estimated_runtime_minutes_excl_db: 70
  estimated_db_download_gb: 38 
  estimated_db_download_minutes: 60
  estimated_time_for_human_minutes: 30
